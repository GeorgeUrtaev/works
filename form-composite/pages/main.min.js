"use strict";

window.onload = function () {
  mainObj.inition();
};
let mainObj = {
  inition() {
    this.production.initSlider();
    this.actionResize();
    this.news.init();
    this.relPro.initSwiper();
  },
  actionClass(tags, className, action) {
    tags.forEach(el => {
      action === 'add' ? el.classList.add(className) : el.classList.remove(className);
    });
  },
  actionResize() {
    window.addEventListener('resize', () => {
      this.news.move();
    });
  },
  submit(instance, e) {
    let data = {
      fio: document.querySelector('._fio'),
      phone: document.querySelector('._phone')
    };
    console.log(data.fio);
    e.preventDefault();
    let field = instance.querySelectorAll('._fioReq');
    field.forEach((el, index, arr) => {
      if (!el.value) {
        el.classList.add("error");
        return;
      } else if (el.classList.contains("error")) {
        el.classList.remove("error");
        return;
      } else {
        this.data.fio = arr[0].value;
        this.data.phone = arr[1].value;
      }
    });
    if (Object.keys(this.data.length !== 0)) console.log('ss', this.data);
  }
};
mainObj.accordeon = {
  show(instance) {
    let accordeon = instance.closest('._accordeon');
    let content = accordeon.querySelector('._accordeonContent');
    let contentHeight = content.querySelector('._contentHeight');
    let arr = instance.querySelector('._accArr');
    let navFixed = instance.closest('.navFixed');
    if (content.classList.contains('show')) {
      content.classList.remove('show');
      arr.classList.remove('active');
      content.style.height = 0;
      navFixed.classList.remove('active');
    } else {
      navFixed.classList.add('active');
      content.classList.add('show');
      arr.classList.add('active');
      content.style.height = contentHeight.offsetHeight + 'px';
    }
  }
};
// _contentHeight



mainObj.gPopup = {
  overlay: document.querySelector('._overlay'),
  body: document.querySelector('body'),
  html: document.querySelector('html'),
  val: document.querySelector('._value'),
  clientsCont: [{
    title: 'норникель'
  }, {
    title: 'кольская гмк'
  }, {
    title: 'русГидро'
  }, {
    title: 'фосагро'
  }, {
    title: 'гидроМонтаж'
  }],
  addActionInOpen() {
    this.overlay.classList.add('open');
    this.body.style.overflow = 'hidden';
    this.html.style.overflow = 'hidden';
  },
  open(contentClass, idx) {
    let popupHtml = document.querySelector(contentClass);
    if (idx) this.val.innerHTML = this.clientsCont[idx].title;
    this.addActionInOpen();
    console.log(popupHtml);
    this.overlay.innerHTML = popupHtml.innerHTML;
  },
  close() {
    this.overlay.classList.remove('open');
    this.body.style.overflow = 'auto';
    this.html.style.overflow = 'auto';
    this.val.innerHTML = 'Возможный контент';
  }
};
mainObj.gSlider = {
  initSlider() {
    const swiper = new Swiper('.swiper', {
      // Optional parameters

      // If we need pagination
      pagination: {
        el: '.swiper-pagination',
        type: 'progressbar'
      },
      // Navigation arrows
      navigation: {
        nextEl: '.swiper-button-next',
        prevEl: '.swiper-button-prev'
      }

      // And if we need scrollbar
      // scrollbar: {
      // 	el: '.swiper-scrollbar',
      // },
    });
  }
};
mainObj.header = {
  headerWrap: document.querySelector('._headerWrap'),
  show(instance) {
    if (instance.classList.contains('active')) {
      instance.classList.remove('active');
      this.headerWrap.classList.remove('active');
    } else {
      instance.classList.add('active');
      this.headerWrap.classList.add('active');
    }
  }
};

mainObj.news = {
  item: document.querySelectorAll('._item'),
  heig: document.querySelectorAll('._heig'),
  move() {
    if (window.innerWidth <= 1100) {
      mainObj.actionClass(document.querySelectorAll('._heig'), 'heig', 'remove');
      if (this.item[0].querySelectorAll('._wr').length > 1) return;
      for (let i = 1; i < this.item.length; i++) {
        let first = this.item[i].querySelector('._wr');
        this.item[i - 1].innerHTML += first.outerHTML;
        first.remove();
      }
    }
    if (window.innerWidth > 1100) {
      mainObj.actionClass(document.querySelectorAll('._heig'), 'heig', 'add');
      for (let i = 0; i < this.item.length; i++) {
        if (!this.item[i + 1] || !this.item[i].querySelectorAll('._wr')[1]) return;
        let last = this.item[i].querySelectorAll('._wr')[1];
        this.item[i + 1].innerHTML += last.outerHTML;
        last.remove();
      }
    }
  },
  init() {
    const swiper = new Swiper('._news__slider', {
      slidesPerView: 1,
      spaceBetween: 30,
      pagination: {
        el: '.swiper-pagination'
      },
      navigation: {
        nextEl: '.swiper-button-next',
        prevEl: '.swiper-button-prev'
      },
      breakpoints: {
        769: {
          slidesPerView: 2
        },
        1025: {
          slidesPerView: 3
        }
      }
    });
  }
};


mainObj.production = {
  initSlider() {
    const swiper = new Swiper('._production', {
      // Optional parameters

      // If we need pagination
      pagination: {
        el: '.swiper-pagination',
        type: 'progressbar'
      },
      // Navigation arrows
      navigation: {
        nextEl: '.swiper-button-next',
        prevEl: '.swiper-button-prev'
      }

      // And if we need scrollbar
      // scrollbar: {
      // 	el: '.swiper-scrollbar',
      // },
    });
  }
};
mainObj.relPro = {
  initSwiper() {
    var swiper = new Swiper(".relPro__Swiper", {
      slidesPerView: 1,
      spaceBetween: 20,
      pagination: {
        el: ".swiper-pagination",
        clickable: true
      }
    });
  }
};



mainObj.tests = {
  initSwiper() {
    var swiper = new Swiper(".mySwiper", {
      spaceBetween: 30,
      pagination: {
        el: ".swiper-pagination",
        clickable: true
      }
    });
  }
};

